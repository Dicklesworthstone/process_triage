{
  "schema_version": "1.0.0",
  "policy_id": "preset:ci",
  "description": "CI preset: headless operation for CI/CD pipelines",
  "created_at": null,
  "updated_at": null,
  "inherits": [],
  "loss_matrix": {
    "useful": {
      "keep": 0.0,
      "pause": 0.5,
      "throttle": 1.0,
      "kill": 500.0,
      "restart": 30.0,
      "renice": 0.3
    },
    "useful_bad": {
      "keep": 0.0,
      "pause": 0.3,
      "throttle": 0.5,
      "kill": 100.0,
      "restart": 15.0,
      "renice": 0.2
    },
    "abandoned": {
      "keep": 5.0,
      "pause": 0.2,
      "throttle": 0.3,
      "kill": 0.2,
      "restart": 1.0,
      "renice": 0.1
    },
    "zombie": {
      "keep": 3.0,
      "pause": 0.1,
      "throttle": 0.1,
      "kill": 0.1,
      "restart": 0.2,
      "renice": 0.05
    }
  },
  "guardrails": {
    "protected_patterns": [
      {
        "pattern": "^systemd$",
        "kind": "regex",
        "case_insensitive": true,
        "notes": "Init system"
      },
      {
        "pattern": "^docker$",
        "kind": "regex",
        "case_insensitive": true,
        "notes": "Docker daemon"
      },
      {
        "pattern": "gitlab-runner",
        "kind": "literal",
        "case_insensitive": true,
        "notes": "GitLab CI runner"
      },
      {
        "pattern": "actions-runner",
        "kind": "literal",
        "case_insensitive": true,
        "notes": "GitHub Actions runner"
      },
      {
        "pattern": "jenkins",
        "kind": "literal",
        "case_insensitive": true,
        "notes": "Jenkins"
      }
    ],
    "force_review_patterns": [],
    "protected_users": [
      "root"
    ],
    "protected_groups": [],
    "protected_categories": [
      "ci_runner",
      "container"
    ],
    "never_kill_ppid": [
      1
    ],
    "never_kill_pid": [],
    "max_kills_per_run": 10,
    "max_kills_per_minute": 5,
    "max_kills_per_hour": 30,
    "max_kills_per_day": 100,
    "min_process_age_seconds": 3600,
    "require_confirmation": false
  },
  "robot_mode": {
    "enabled": true,
    "min_posterior": 0.95,
    "min_confidence": "high",
    "max_blast_radius_mb": 4096.0,
    "max_kills": 10,
    "require_known_signature": false,
    "require_policy_snapshot": null,
    "allow_categories": [
      "test_runner",
      "build_tool"
    ],
    "exclude_categories": [
      "ci_runner"
    ],
    "require_human_for_supervised": false
  },
  "signature_fast_path": {
    "enabled": true,
    "min_confidence_threshold": 0.9,
    "require_explicit_priors": true
  },
  "fdr_control": {
    "enabled": true,
    "method": "bh",
    "alpha": 0.05,
    "min_candidates": null,
    "lfdr_null": [],
    "alpha_investing": null
  },
  "data_loss_gates": {
    "block_if_open_write_fds": true,
    "max_open_write_fds": 3,
    "block_if_locked_files": true,
    "block_if_deleted_cwd": null,
    "block_if_active_tty": false,
    "block_if_recent_io_seconds": 60
  },
  "load_aware": {
    "enabled": false,
    "queue_high": 50,
    "load_per_core_high": 1.0,
    "memory_used_fraction_high": 0.85,
    "psi_avg10_high": 20.0,
    "weights": {
      "queue": 0.25,
      "load": 0.35,
      "memory": 0.25,
      "psi": 0.15
    },
    "multipliers": {
      "keep_max": 1.4,
      "reversible_min": 0.6,
      "risky_max": 1.8
    }
  },
  "decision_time_bound": {
    "enabled": true,
    "min_seconds": 30,
    "max_seconds": 300,
    "voi_decay_half_life_seconds": 60,
    "voi_floor": 0.01,
    "overhead_budget_seconds": 120,
    "fallback_action": "keep"
  },
  "notes": "Designed for CI/CD automation - no interactive prompts, specific exit codes"
}